<!--
  Modified track component template
  - Removed the layout chip showing the layout label below the flag.
  - Simplified layout details to just show length and years.
  - Adjusted recent winners list to allow a more flexible layout.
-->
<div class="card">
  <div class="controls">
    <div class="field span-6">
      <label for="trackSelect">Grand Prix</label>
      <select
        id="trackSelect"
        class="select select--dark border"
        [(ngModel)]="selectedKey"
        (ngModelChange)="onSelectTrack()"
      >
        <option [ngValue]="null" disabled>— choose a track —</option>
        <option *ngFor="let track of tracks" [ngValue]="track.key">
          {{ track.country_code ? track.country_code + ' - ' : '' }}{{ track.display_name }}
        </option>
      </select>
    </div>

    <div class="field span-3" *ngIf="layoutVariants.length > 1">
      <label for="variantSelect">Layout</label>
      <select
        id="variantSelect"
        class="select select--dark border"
        [(ngModel)]="selectedVariantSignature"
        (ngModelChange)="onVariantSelect($event)"
      >
        <option *ngFor="let variant of layoutVariants" [ngValue]="variant.layout_signature">
          {{ variant.layout_label || variant.circuit_name || 'Layout' }}
        </option>
      </select>
    </div>
  </div>

  <div class="track-header" *ngIf="selectedTrack">
    <div class="flag-wrapper" *ngIf="flagClass(selectedTrack) as flagClasses">
      <span class="flag-icon" [ngClass]="flagClasses" aria-hidden="true"></span>
    </div>
    <div class="title-text">
      <h2>{{ selectedTrack.display_name }}</h2>
      <div class="subtitle">
        <span *ngIf="selectedTrack.location">{{ selectedTrack.location }}</span>
        <span *ngIf="selectedTrack.country">• {{ selectedTrack.country }}</span>
        <span *ngIf="selectedRound">• {{ selectedRound.year }} (Round {{ selectedRound.round }})</span>
      </div>
    </div>
  </div>

  <div class="layout-details" *ngIf="trackMap">
    <div class="layout-meta">
      <span *ngIf="trackMap.layout_length as length">Length: {{ length | number: '1.3-3' }} km</span>
      <span *ngIf="layoutYearsLabel as years">Years: {{ years }}</span>
    </div>
  </div>

  <div class="map-card" *ngIf="trackMap || loading || error" [class.map-card--loading]="loading">
    <svg class="track" id="trackMap" width="800" height="600"></svg>
    <div class="map-overlay" *ngIf="loading">Loading track …</div>
    <div class="map-overlay error" *ngIf="!loading && error">{{ error }}</div>
  </div>

  <div class="winner-list" *ngIf="displayWinners.length">
    <h3>Recent winners</h3>
    <ul>
      <li *ngFor="let winner of displayWinners">
        <span class="year">{{ winner.year }}</span>
        <div class="winner-info">
          <span class="name">{{ winner.driver || 'Unknown driver' }}</span>
          <span class="team" *ngIf="winner.team">({{ winner.team }})</span>
        </div>
      </li>
    </ul>
  </div>

  <footer class="footer">© {{ currentYear }} GridStats</footer>
</div>